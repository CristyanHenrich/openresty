worker_processes  1;
error_log /dev/stderr warn;

events {
    worker_connections 1024;
}

env JWT_SECRET;

http {
    lua_package_path "/usr/local/openresty/lualib/?.lua;;";

    server {
        listen 8082;

        server_name api.playground.dev.br;

        location / {
            access_by_lua_file /bearer.lua;
            default_type 'application/json';
            set $jwt_ip $http_x_ip;
            set $jwt_socket $http_x_socket;
            set $jwt_api $http_x_api;
            return 200 "$jwt_ip, $jwt_socket, $jwt_api";
        }
    }
}
